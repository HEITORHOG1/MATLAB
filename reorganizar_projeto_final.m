function reorganizar_projeto_final()
    % ========================================================================
    % REORGANIZAR_PROJETO_FINAL - Limpeza e Organiza√ß√£o Final do Projeto
    % ========================================================================
    % 
    % DESCRI√á√ÉO:
    %   Script para limpar arquivos obsoletos e reorganizar a estrutura final
    %   do projeto Sistema de Compara√ß√£o U-Net vs Attention U-Net
    %
    % AUTOR: Sistema de Compara√ß√£o U-Net vs Attention U-Net
    % Data: Julho 2025
    % ========================================================================
    
    fprintf('üßπ REORGANIZA√á√ÉO FINAL DO PROJETO\n');
    fprintf('=================================\n\n');
    
    try
        % 1. Criar estrutura de diret√≥rios necess√°ria
        criarEstruturaDiretorios();
        
        % 2. Mover arquivos para pastas corretas
        moverArquivosParaPastas();
        
        % 3. Remover arquivos obsoletos
        removerArquivosObsoletos();
        
        % 4. Verificar arquivo principal de execu√ß√£o
        verificarArquivoPrincipal();
        
        % 5. Atualizar documenta√ß√£o
        atualizarDocumentacao();
        
        fprintf('‚úÖ Reorganiza√ß√£o conclu√≠da com sucesso!\n');
        fprintf('\nüìã COMO USAR O SISTEMA:\n');
        fprintf('1. Execute: executar_comparacao\n');
        fprintf('2. Siga as instru√ß√µes do menu interativo\n');
        fprintf('3. Para ajuda: consulte docs/COMO_USAR.md\n');
        fprintf('\n‚ö†Ô∏è  IMPORTANTE: Use APENAS executar_comparacao.m como ponto de entrada!\n\n');
        
    catch ME
        fprintf('‚ùå Erro na reorganiza√ß√£o: %s\n', ME.message);
        rethrow(ME);
    end
end

function criarEstruturaDiretorios()
    % Criar estrutura de diret√≥rios necess√°ria
    
    fprintf('üìÅ Criando estrutura de diret√≥rios...\n');
    
    diretorios = {
        'scripts'           % Scripts auxiliares
        'utils'             % Utilit√°rios gerais
        'legacy'            % Arquivos antigos (para backup)
        'validation'        % Scripts de valida√ß√£o
        'examples'          % Exemplos de uso
        'config/templates'  % Templates de configura√ß√£o
    };
    
    for i = 1:length(diretorios)
        if ~exist(diretorios{i}, 'dir')
            mkdir(diretorios{i});
            fprintf('  ‚úì Criado: %s\n', diretorios{i});
        end
    end
end

function moverArquivosParaPastas()
    % Mover arquivos para suas pastas corretas
    
    fprintf('\nüì¶ Movendo arquivos para pastas corretas...\n');
    
    % Scripts auxiliares para pasta scripts/
    scripts_auxiliares = {
        'configuracao_inicial_automatica.m'
        'configurar_caminhos.m'
        'criar_estrutura_diretorios.m'
        'install_system.m'
        'migrate_system.m'
        'testar_configuracao.m'
        'verificar_diretorios.m'
        'inicio_rapido.m'
        'exportar_configuracao_portatil.m'
    };
    
    for i = 1:length(scripts_auxiliares)
        arquivo = scripts_auxiliares{i};
        if exist(arquivo, 'file')
            movefile(arquivo, fullfile('scripts', arquivo));
            fprintf('  ‚úì Movido: %s ‚Üí scripts/\n', arquivo);
        end
    end
    
    % Scripts de valida√ß√£o para pasta validation/
    scripts_validacao = {
        'simple_validation.m'
        'simple_performance_validation.m'
        'validate_comparison_controller.m'
        'validate_config_manager.m'
        'validate_performance_optimizations.m'
        'validate_system_consistency.m'
        'validate_visualization_system.m'
        'verificacao_final_projeto.m'
        'test_comparison_controller.m'
        'test_config_manager.m'
        'test_main_interface.m'
    };
    
    for i = 1:length(scripts_validacao)
        arquivo = scripts_validacao{i};
        if exist(arquivo, 'file')
            movefile(arquivo, fullfile('validation', arquivo));
            fprintf('  ‚úì Movido: %s ‚Üí validation/\n', arquivo);
        end
    end
    
    % Utilit√°rios para pasta utils/
    utils_files = {
        'analisar_mascaras_automatico.m'
        'analise_metricas_detalhada.m'
        'calcular_accuracy_simples.m'
        'calcular_dice_simples.m'
        'calcular_iou_simples.m'
        'carregar_dados_robustos.m'
        'converter_mascaras.m'
        'gerar_relatorio_final.m'
        'preprocessDataCorrigido.m'
        'preprocessDataMelhorado.m'
        'treinar_unet_simples.m'
    };
    
    for i = 1:length(utils_files)
        arquivo = utils_files{i};
        if exist(arquivo, 'file')
            movefile(arquivo, fullfile('utils', arquivo));
            fprintf('  ‚úì Movido: %s ‚Üí utils/\n', arquivo);
        end
    end
    
    % Arquivos legados para pasta legacy/
    legacy_files = {
        'comparacao_unet_attention_final.m'
        'create_working_attention_unet.m'
        'executar_testes_completos.m'
        'remover_arquivos_obsoletos.m'
    };
    
    for i = 1:length(legacy_files)
        arquivo = legacy_files{i};
        if exist(arquivo, 'file')
            movefile(arquivo, fullfile('legacy', arquivo));
            fprintf('  ‚úì Movido: %s ‚Üí legacy/\n', arquivo);
        end
    end
end

function removerArquivosObsoletos()
    % Remover arquivos que n√£o s√£o mais necess√°rios
    
    fprintf('\nüóëÔ∏è  Removendo arquivos obsoletos...\n');
    
    arquivos_obsoletos = {
        'config_caminhos.mat'           % Substitu√≠do por ConfigManager
        'relatorio_comparacao.txt'      % Ser√° gerado automaticamente
        'comparacao_visual_modelos.png' % Ser√° gerado automaticamente
    };
    
    for i = 1:length(arquivos_obsoletos)
        arquivo = arquivos_obsoletos{i};
        if exist(arquivo, 'file')
            delete(arquivo);
            fprintf('  ‚úì Removido: %s\n', arquivo);
        end
    end
end

function verificarArquivoPrincipal()
    % Verificar se o arquivo principal de execu√ß√£o existe e est√° correto
    
    fprintf('\nüìù Verificando arquivo principal de execu√ß√£o...\n');
    
    % Verificar se executar_comparacao.m existe
    if exist('executar_comparacao.m', 'file')
        fprintf('  ‚úÖ executar_comparacao.m encontrado (arquivo principal correto)\n');
    else
        error('‚ùå Arquivo principal executar_comparacao.m n√£o encontrado!');
    end
    
    % Verificar se arquivos duplicados foram renomeados para .backup
    arquivos_backup = {
        'main_sistema_comparacao.m.backup';
        'executar_comparacao_automatico.m.backup'
    };
    
    for i = 1:length(arquivos_backup)
        arquivo = arquivos_backup{i};
        if exist(arquivo, 'file')
            fprintf('  ‚úÖ %s encontrado (duplicata corretamente renomeada)\n', arquivo);
        else
            fprintf('  ‚ö†Ô∏è  %s n√£o encontrado (pode ter sido removido)\n', arquivo);
        end
    end
    
    % Verificar se n√£o existem arquivos duplicados ativos
    arquivos_duplicados = {
        'main_sistema_comparacao.m';
        'executar_comparacao_automatico.m'
    };
    
    for i = 1:length(arquivos_duplicados)
        arquivo = arquivos_duplicados{i};
        if exist(arquivo, 'file')
            fprintf('  ‚ö†Ô∏è  AVISO: %s ainda existe (deveria ser renomeado para .backup)\n', arquivo);
        end
    end
    
    fprintf('  ‚úÖ Verifica√ß√£o do arquivo principal conclu√≠da\n');
end

function atualizarDocumentacao()
    % Atualizar documenta√ß√£o com instru√ß√µes de uso
    
    fprintf('\nüìö Atualizando documenta√ß√£o...\n');
    
    % Criar guia de como usar
    criarGuiaComoUsar();
    
    % Atualizar README principal
    atualizarREADME();
    
    fprintf('  ‚úì Documenta√ß√£o atualizada\n');
end

function criarGuiaComoUsar()
    % Criar guia detalhado de como usar o sistema
    
    conteudo_guia = [
        '# Como Usar o Sistema de Compara√ß√£o U-Net vs Attention U-Net\n\n'...
        '## üöÄ In√≠cio R√°pido\n\n'...
        '### 1. Execu√ß√£o Simples\n'...
        '```matlab\n'...
        '% No MATLAB, navegue at√© o diret√≥rio do projeto e execute:\n'...
        'main_sistema_comparacao\n'...
        '```\n\n'...
        '### 2. Primeira Execu√ß√£o\n'...
        '1. **Prepare seus dados**: Coloque imagens em `img/original/` e m√°scaras em `img/masks/`\n'...
        '2. **Execute o sistema**: `main_sistema_comparacao`\n'...
        '3. **Escolha op√ß√£o 1**: "Execu√ß√£o R√°pida" para teste inicial\n'...
        '4. **Aguarde**: O sistema executar√° automaticamente\n\n'...
        '## üìÅ Estrutura do Projeto\n\n'...
        '```\n'...
        'projeto/\n'...
        '‚îú‚îÄ‚îÄ main_sistema_comparacao.m    # üöÄ ARQUIVO PRINCIPAL - EXECUTE ESTE\n'...
        '‚îú‚îÄ‚îÄ src/                         # C√≥digo fonte principal\n'...
        '‚îÇ   ‚îú‚îÄ‚îÄ core/                    # Classes principais\n'...
        '‚îÇ   ‚îú‚îÄ‚îÄ data/                    # Carregamento e processamento\n'...
        '‚îÇ   ‚îú‚îÄ‚îÄ models/                  # Arquiteturas de rede\n'...
        '‚îÇ   ‚îú‚îÄ‚îÄ evaluation/              # M√©tricas e avalia√ß√£o\n'...
        '‚îÇ   ‚îú‚îÄ‚îÄ visualization/           # Gr√°ficos e relat√≥rios\n'...
        '‚îÇ   ‚îî‚îÄ‚îÄ utils/                   # Utilit√°rios do sistema\n'...
        '‚îú‚îÄ‚îÄ img/                         # Seus dados\n'...
        '‚îÇ   ‚îú‚îÄ‚îÄ original/                # üì∏ COLOQUE SUAS IMAGENS AQUI\n'...
        '‚îÇ   ‚îî‚îÄ‚îÄ masks/                   # üé≠ COLOQUE SUAS M√ÅSCARAS AQUI\n'...
        '‚îú‚îÄ‚îÄ output/                      # Resultados (criado automaticamente)\n'...
        '‚îú‚îÄ‚îÄ docs/                        # Documenta√ß√£o completa\n'...
        '‚îú‚îÄ‚îÄ scripts/                     # Scripts auxiliares\n'...
        '‚îú‚îÄ‚îÄ utils/                       # Utilit√°rios gerais\n'...
        '‚îú‚îÄ‚îÄ validation/                  # Scripts de valida√ß√£o\n'...
        '‚îî‚îÄ‚îÄ examples/                    # Exemplos de uso\n'...
        '```\n\n'...
        '## üéØ Op√ß√µes do Menu Principal\n\n'...
        '### 1. üöÄ Execu√ß√£o R√°pida\n'...
        '- **Para**: Iniciantes, teste r√°pido\n'...
        '- **Tempo**: 5-15 minutos\n'...
        '- **Dados**: 10% do dataset\n'...
        '- **Ideal para**: Primeira execu√ß√£o, valida√ß√£o dos dados\n\n'...
        '### 2. ‚öôÔ∏è Configurar Dados e Par√¢metros\n'...
        '- **Para**: Configura√ß√£o personalizada\n'...
        '- **Permite**: Ajustar caminhos, par√¢metros de treinamento\n'...
        '- **Ideal para**: Datasets em locais diferentes\n\n'...
        '### 3. üî¨ Compara√ß√£o Completa\n'...
        '- **Para**: An√°lise detalhada\n'...
        '- **Tempo**: 30-120 minutos\n'...
        '- **Dados**: Dataset completo\n'...
        '- **Ideal para**: Resultados finais, publica√ß√£o\n\n'...
        '### 4. üìä Valida√ß√£o Cruzada K-Fold\n'...
        '- **Para**: Valida√ß√£o robusta\n'...
        '- **Tempo**: 2-8 horas\n'...
        '- **Dados**: Dataset completo, m√∫ltiplas divis√µes\n'...
        '- **Ideal para**: Pesquisa cient√≠fica, m√°xima confiabilidade\n\n'...
        '## üìä Interpretando Resultados\n\n'...
        '### M√©tricas Principais\n'...
        '- **IoU (Intersection over Union)**: 0-1, maior √© melhor (>0.7 = bom)\n'...
        '- **Dice Coefficient**: 0-1, maior √© melhor (>0.8 = bom)\n'...
        '- **Pixel Accuracy**: 0-100%, maior √© melhor (>90% = bom)\n\n'...
        '### Arquivos de Resultado\n'...
        '- `output/reports/`: Relat√≥rios detalhados\n'...
        '- `output/models/`: Modelos treinados\n'...
        '- `output/visualizations/`: Gr√°ficos e compara√ß√µes visuais\n\n'...
        '## üîß Solu√ß√£o de Problemas\n\n'...
        '### Erro: "Dados n√£o encontrados"\n'...
        '1. Verifique se as imagens est√£o em `img/original/`\n'...
        '2. Verifique se as m√°scaras est√£o em `img/masks/`\n'...
        '3. Use a op√ß√£o 2 do menu para configurar caminhos\n\n'...
        '### Erro: "Mem√≥ria insuficiente"\n'...
        '1. Use a op√ß√£o 1 (Execu√ß√£o R√°pida) primeiro\n'...
        '2. Feche outros programas\n'...
        '3. O sistema tem otimiza√ß√µes autom√°ticas de mem√≥ria\n\n'...
        '### Erro: "Toolbox n√£o encontrada"\n'...
        '1. Instale Deep Learning Toolbox\n'...
        '2. Instale Image Processing Toolbox\n'...
        '3. Verifique com: `ver`\n\n'...
        '## üìû Ajuda Adicional\n\n'...
        '- **Menu de Ajuda**: Op√ß√£o 7 no menu principal\n'...
        '- **Documenta√ß√£o Completa**: `docs/user_guide.md`\n'...
        '- **API Reference**: `docs/api_reference.md`\n'...
        '- **Valida√ß√£o do Sistema**: Execute `validation/simple_validation.m`\n\n'...
        '## üéØ Dicas de Performance\n\n'...
        '### Para Datasets Grandes\n'...
        '- O sistema usa lazy loading automaticamente\n'...
        '- Cache inteligente otimiza processamento\n'...
        '- Monitoramento autom√°tico de recursos\n\n'...
        '### Para M√°xima Velocidade\n'...
        '- Use GPU se dispon√≠vel (detectado automaticamente)\n'...
        '- Sistema usa processamento paralelo quando poss√≠vel\n'...
        '- Otimiza√ß√µes de mem√≥ria s√£o autom√°ticas\n\n'...
        '---\n\n'...
        '**Vers√£o**: 3.0 - Performance Optimization  \n'...
        '**Data**: Julho 2025  \n'...
        '**Compatibilidade**: MATLAB R2019b+\n'
    ];
    
    % Escrever guia
    fid = fopen('docs/COMO_USAR.md', 'w');
    if fid == -1
        error('N√£o foi poss√≠vel criar guia de uso');
    end
    fprintf(fid, '%s', conteudo_guia);
    fclose(fid);
end

function atualizarREADME()
    % Atualizar README principal com instru√ß√µes claras
    
    conteudo_readme = [
        '# Sistema de Compara√ß√£o U-Net vs Attention U-Net\n\n'...
        '## üöÄ In√≠cio R√°pido\n\n'...
        '### Execute em 3 passos:\n\n'...
        '1. **Prepare os dados**:\n'...
        '   - Coloque suas imagens em: `img/original/`\n'...
        '   - Coloque suas m√°scaras em: `img/masks/`\n\n'...
        '2. **Execute o sistema**:\n'...
        '   ```matlab\n'...
        '   executar_comparacao\n'...
        '   ```\n\n'...
        '3. **Escolha a op√ß√£o 1** no menu para execu√ß√£o r√°pida\n\n'...
        '## üìã Requisitos\n\n'...
        '- MATLAB R2019b ou superior\n'...
        '- Deep Learning Toolbox\n'...
        '- Image Processing Toolbox\n'...
        '- M√≠nimo 4GB RAM (recomendado: 8GB+)\n\n'...
        '## üéØ Caracter√≠sticas\n\n'...
        '- ‚úÖ **Totalmente Automatizado**: Execute com um comando\n'...
        '- ‚úÖ **An√°lise Estat√≠stica**: Testes de signific√¢ncia\n'...
        '- ‚úÖ **Otimizado**: Lazy loading, cache inteligente\n'...
        '- ‚úÖ **Monitoramento**: Recursos em tempo real\n'...
        '- ‚úÖ **Port√°vel**: Funciona em qualquer sistema\n\n'...
        '## üìä Resultados\n\n'...
        'O sistema compara duas arquiteturas:\n'...
        '- **U-Net Cl√°ssica**: Encoder-decoder com skip connections\n'...
        '- **Attention U-Net**: U-Net com mecanismos de aten√ß√£o\n\n'...
        'M√©tricas calculadas:\n'...
        '- IoU (Intersection over Union)\n'...
        '- Dice Coefficient\n'...
        '- Pixel Accuracy\n'...
        '- An√°lise estat√≠stica completa\n\n'...
        '## üìÅ Estrutura\n\n'...
        '```\n'...
        'executar_comparacao.m      ‚Üê üöÄ EXECUTE ESTE ARQUIVO\n'...
        'src/                       ‚Üê C√≥digo fonte\n'...
        'img/original/              ‚Üê üì∏ SUAS IMAGENS AQUI\n'...
        'img/masks/                 ‚Üê üé≠ SUAS M√ÅSCARAS AQUI\n'...
        'output/                    ‚Üê Resultados autom√°ticos\n'...
        'docs/                      ‚Üê Documenta√ß√£o completa\n'...
        '```\n\n'...
        '## üîß Solu√ß√£o R√°pida de Problemas\n\n'...
        '| Problema | Solu√ß√£o |\n'...
        '|----------|----------|\n'...
        '| "Dados n√£o encontrados" | Coloque imagens em `img/original/` e m√°scaras em `img/masks/` |\n'...
        '| "Mem√≥ria insuficiente" | Use op√ß√£o 1 (Execu√ß√£o R√°pida) primeiro |\n'...
        '| "Toolbox n√£o encontrada" | Instale Deep Learning Toolbox e Image Processing Toolbox |\n\n'...
        '## üìö Documenta√ß√£o\n\n'...
        '- **[Como Usar](docs/COMO_USAR.md)**: Guia passo a passo\n'...
        '- **[Guia do Usu√°rio](docs/user_guide.md)**: Documenta√ß√£o completa\n'...
        '- **[API Reference](docs/api_reference.md)**: Refer√™ncia t√©cnica\n\n'...
        '## üéØ Vers√£o Atual\n\n'...
        '**Vers√£o 3.0 - Performance Optimization**\n'...
        '- Lazy loading para datasets grandes\n'...
        '- Cache inteligente de dados\n'...
        '- Monitoramento autom√°tico de recursos\n'...
        '- Identifica√ß√£o autom√°tica de gargalos\n'...
        '- Interface unificada e intuitiva\n\n'...
        '---\n\n'...
        '**Desenvolvido para**: Pesquisa em segmenta√ß√£o sem√¢ntica com deep learning  \n'...
        '**Compatibilidade**: MATLAB R2019b+  \n'...
        '**Licen√ßa**: Acad√™mica  \n'
    ];
    
    % Escrever README
    fid = fopen('README.md', 'w');
    if fid == -1
        error('N√£o foi poss√≠vel atualizar README');
    end
    fprintf(fid, '%s', conteudo_readme);
    fclose(fid);
end